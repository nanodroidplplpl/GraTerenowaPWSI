{#<!-- gra/pokaz_azymut.html -->#}
{#<!DOCTYPE html>#}
{#<html>#}
{#<head>#}
{#    <title>Pokaz Azymut</title>#}
{#    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>#}
{#    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css"/>#}
{#    <style>#}
{#        #map {#}
{#            height: 400px;#}
{#        }#}
{#    </style>#}
{#</head>#}
{#<body>#}
{#<h1>Pokaz Azymut</h1>#}
{#<div id="azymut">#}
{#    <h2>Azymut</h2>#}
{#    <span>#}
{#            {% if azymut %}#}
{#                {{ azymut }}#}
{#            {% else %}#}
{#                Północ#}
{#            {% endif %}#}
{#        </span>#}
{#    <h2>Zostało:</h2>#}
{#    <span>{{ parametr_django }}</span>#}
{#</div>#}
{#<div>#}
{#    <h2>Miejsca</h2>#}
{#    <select id="miejsca">#}
{#        {% for miejsce in miejsca %}#}
{#            <option value="{{ miejsce.id }}">{{ miejsce.nazwa }}</option>#}
{#        {% endfor %}#}
{#    </select>#}
{#</div>#}
{#<div id="map"></div>#}
{#<script>#}
{#    var map = L.map('map').setView([51.505, -0.09], 13);#}
{##}
{#    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {#}
{#        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',#}
{#        maxZoom: 18,#}
{#    }).addTo(map);#}
{##}
{#    var punkty = [#}
{#        {% for punkt in punkty %}#}
{#            [{{ punkt.lat }}, {{ punkt.lng }}],#}
{#        {% endfor %}#}
{#    ];#}
{##}
{#    for (var i = 0; i < punkty.length; i++) {#}
{#        L.marker(punkty[i]).addTo(map);#}
{#    }#}
{#</script>#}
{#</body>#}
{#</html>#}

{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Pokaz Azymut</title>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <style>
        #map {
            height: 400px;
        }
    </style>
</head>
<body>
{% include 'gra/navbar.html' %}
<div class="container">
    <h1 class="mt-5">Pokaz Azymut</h1>
    <div id="azymut" class="mt-4">
        <h2>Azymut</h2>
        <span class="h3">
            {% if azymut %}
                {{ azymut }}
            {% else %}
                Północ
            {% endif %}
        </span>
        <h2 class="mt-4">Zostało:</h2>
        <span class="h3">{{ parametr_django }}</span>
    </div>
    <div class="mt-4">
        <h2>Miejsca</h2>
        <select id="miejsca" class="form-control">
            {% for task in tasks %}
                <option value="{{ task.id_zadania }}">{{ task.nazwa_zadania }}</option>
            {% endfor %}
        </select>
    </div>
    <div id="map" class="mt-4"></div>
</div>


<script>
    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
        maxZoom: 18,
    }).addTo(map);

    var tasks = [
        {% for task in tasks %}
            {
                lat: {{ task.lat }},
                lon: {{ task.lon }},
                nazwa: "{{ task.nazwa_zadania }}",
                opis: "{{ task.opis_zadania }}",
                password: "{{ task.password }}"
            },
        {% endfor %}
    ];

    for (var i = 0; i < tasks.length; i++) {
        var task = tasks[i];
        var marker = L.marker([task.lat, task.lon]).addTo(map);




        marker.on('click', function () {
            var confirmation = confirm( task.nazwa + '\nCzy jesteś na miejscu?');
            if (confirmation) {
                var password = prompt('Proszę wprowadzić hasło:');
                if (password !== null && password === task.password) {
                    alert('Dziekujemy za przeslanie odpowedzi');
                    // Perform further actions if needed

                    // Remove the marker from the map
                    map.removeLayer(marker);
                } else {
                    alert('Dziekujemy za przeslanie odpowedzi');
                    map.removeLayer(marker);
                    // Perform further actions if needed
                }
            }
        });
    }
</script>




</body>
</html>


